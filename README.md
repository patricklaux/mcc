# mcc

mcc (mini c compiler) 是一个小型的 C 编译器，仅支持有限的 C 语言特性，主要思路来源于 **C4**。

C4 仅用了极少量代码和极有限特性完成了自举（1个文件4个函数），整个实现很精巧，但非常晦涩并不适合新手阅读。

正所谓：编译过程一遍过，递归调用循环调，全局变量随便变，类型转换强制转。

mcc 则走的是完全相反的路，一切以可阅读可理解为目标。

### 编译运行

```bash
# 下载源码
git clone git@github.com:patricklaux/mcc.git

# 编译 mcc
gcc -o mcc ./src/mcc/lexer.c ./src/mcc/parser.c ./src/mcc/vm.c ./src/mcc/mcc.c

# 使用 mcc 运行测试代码
./mcc [-s] [-d] ./src/test/test1.c
```

**提示**：

1. 以上命令在 Windows 10 和 Ubuntu 22.04 均正常运行。
2. 除了直接用 gcc 编译，也可以用 cmake，这里不再赘述。
3. -s 和 -d 是可选参数： -s 会打印生成的指令，但不执行；-d 会运行并打印每一条指令。

### 简单介绍

mcc 主要有 4 个文件，整个编译运行过程分为三个部分，如下表所示。

| 文件  | 功能介绍                     |
| :---: | ---------------------------- |
|  mcc  | 主控程序                     |
| lexer | 词法分析                     |
| parer | 语法分析、语义分析、代码生成 |
|  vm   | 虚拟机，运行指令             |

